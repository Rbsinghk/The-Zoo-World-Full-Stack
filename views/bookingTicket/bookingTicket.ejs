<%- include('../layout/header')%>
    <!DOCTYPE html>
    <html lang="en">

    <head>
        <meta charset="UTF-8">
        <meta http-equiv="X-UA-Compatible" content="IE=edge">
        <meta name="viewport" content="width=device-width, initial-scale=1.0">
        <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/bootstrap@4.6.1/dist/css/bootstrap.min.css"
            integrity="sha384-zCbKRCUGaJDkqS1kPbPd7TveP5iyJE0EjAuZQTgFLD2ylzuqKfdKlfG/eSrtxUkn" crossorigin="anonymous">
        <style>
            body,
            html {
                height: 100%;
            }

            form {
                padding: 20px;
            }

            .d {
                background-image: url('pexels-photo-1829979.jpeg');
                height: auto;
                max-width: 100%;
                filter: blur(8px);
                -webkit-filter: blur(8px);
                height: 100%;
                background-position: center;
                background-repeat: no-repeat;
                background-size: cover;
            }

            .con {
                background-color: rgb(0, 0, 0);
                background-color: rgba(0, 0, 0, 0.4);
                color: white;
                font-weight: bold;
                border: 3px solid #f1f1f1;
                position: absolute;
                top: 50%;
                left: 50%;
                transform: translate(-50%, -50%);
                z-index: 2;
                width: 80%;
                padding: 20px;
                text-align: center;
            }
        </style>
        <title>bookinTicket</title>
    </head>

    <body>
        <div class="d"></div>
        <form class="con">
            <div class="form-group row">
                <label for="inputEmail3" class="col-sm-2 col-form-label">Name</label>
                <div class="col-sm-5">
                    <input type="text" class="form-control" id="name" name="name">
                </div>
            </div>
            <div class="form-group row">
                <label for="inputEmail3" class="col-sm-2 col-form-label">Email</label>
                <div class="col-sm-5">
                    <input type="email" class="form-control" id="email" name="email">
                </div>
            </div>
            <div class="form-group row">
                <label for="inputPassword3" class="col-sm-2 col-form-label">Mobile No.</label>
                <div class="col-sm-5">
                    <input type="mobile" class="form-control" id="mobile" name="mobile">
                </div>
            </div>
            <div class="form-group row">
                <label for="inputPassword3" class="col-sm-2 col-form-label" id="person">Person</label>
                <div class="col-sm-5">
                    <select class="custom-select custom-select-mb" id="kids" name="kids">
                        <option selected>Kids</option>
                        <option value="1">0</option>
                        <option value="1">1</option>
                        <option value="2">2</option>
                        <option value="3">3</option>
                        <option value="4">4</option>
                        <option value="5">5</option>
                        <option value="6">6</option>
                        <option value="7">7</option>
                        <option value="8">8</option>
                        <option value="9">9</option>
                        <option value="10">10</option>
                        <option value="11">11</option>
                        <option value="12">12</option>
                    </select>

                    <select class="custom-select custom-select-mb" id="adult" name="adult">
                        <option selected>Adult</option>
                        <option value="1">0</option>
                        <option value="1">1</option>
                        <option value="2">2</option>
                        <option value="3">3</option>
                        <option value="4">4</option>
                        <option value="5">5</option>
                        <option value="6">6</option>
                        <option value="7">7</option>
                        <option value="8">8</option>
                        <option value="9">9</option>
                        <option value="10">10</option>
                        <option value="11">11</option>
                        <option value="12">12</option>
                    </select>

                    <select class="custom-select custom-select-mb" id="srCitizen" name="srCitizen">
                        <option selected>SrCitizen</option>
                        <option value="1">0</option>
                        <option value="1">1</option>
                        <option value="2">2</option>
                        <option value="3">3</option>
                        <option value="4">4</option>
                        <option value="5">5</option>
                        <option value="6">6</option>
                        <option value="7">7</option>
                        <option value="8">8</option>
                        <option value="9">9</option>
                        <option value="10">10</option>
                        <option value="11">11</option>
                        <option value="12">12</option>
                    </select>
                </div>
            </div>
            <div class="form-group row">
                <label for="inputPassword3" class="col-sm-2 col-form-label">DateOfVisit</label>
                <div class="col-sm-5">
                    <input type="date" class="form-control" id="dateOfVisit" name="dateOfVisit">
                </div>
            </div>

            <div class="form-group row">
                <div class="col-sm-5 offset-sm-2">
                </div>
            </div>
            </div>
            <div class="form-group row">
                <div class="col-sm-5">
                    <button type="submit" onclick=" event.preventDefault(); bookinTicket();"
                        class="btn btn-primary">Submit</button>
                </div>
            </div>
        </form>

        <script src="https://cdn.jsdelivr.net/npm/jquery@3.5.1/dist/jquery.slim.min.js"
            integrity="sha384-DfXdz2htPH0lsSSs5nCTpuj/zy4C+OGpamoFVy38MVBnE+IbbVYUew+OrCXaRkfj"
            crossorigin="anonymous"></script>
        <script src="https://cdn.jsdelivr.net/npm/popper.js@1.16.1/dist/umd/popper.min.js"
            integrity="sha384-9/reFTGAW83EW2RDu2S0VKaIzap3H66lZH81PoYlFhbGU+6BZp6G7niu735Sk7lN"
            crossorigin="anonymous"></script>
        <script src="https://cdn.jsdelivr.net/npm/bootstrap@4.6.1/dist/js/bootstrap.min.js"
            integrity="sha384-VHvPCCyXqtD5DqJeNxl2dtTyhF78xXNXdkwX1CZeRusQfRKp+tA7hAShOK/B/fQ2"
            crossorigin="anonymous"></script>
        <script src="https://ajax.googleapis.com/ajax/libs/jquery/3.6.0/jquery.min.js"></script>

        <script>
            function bookinTicket() {
                const name = document.getElementById("name").value;
                const email = document.getElementById("email").value;
                const mobile = document.getElementById("mobile").value;
                const kids = document.getElementById("kids").value;
                const adult = document.getElementById("adult").value;
                const srCitizen = document.getElementById("srCitizen").value;
                const dateOfVisit = document.getElementById("dateOfVisit").value;
                const data = { name, email, mobile, kids, adult, srCitizen, dateOfVisit }
                var token = localStorage.getItem('auth-token');
                var headers = {}
                headers['auth-token'] = token
                $.ajax({
                    type: "POST",
                    url: "/booking/bookinTicket",
                    headers: headers,
                    data: data,
                    dataType: "json",
                    success: (res) => {
                        console.log(res)
                        if (res._id != undefined) {
                            const name = document.getElementById("name").value;
                            const currency = "USD";
                            const ticketId = res._id
                            const payData = { name, currency, ticketId }
                            $.ajax({
                                type: "POST",
                                url: "/booking/bookinTicket/pay",
                                data: payData,
                                success: (res2) => {
                                    console.log(res2)
                                    window.location = res2
                                    // console.log(payData)
                                },
                                error: (error) => {
                                    console.log(error)
                                }
                            })
                        }
                        else if (res === "Name not be empty") {
                            alert("Name not be empty")
                        }
                        else if (res === "Email not be empty") {
                            alert("Email not be empty")
                        }
                        else if (res === "number no is not empty") {
                            alert("number no is not empty")
                        }
                        else if (res === "The dateOfVisit is not empty") {
                            alert("The dateOfVisit is not empty")
                        }
                        else if (res === "number should be 10 digit") {
                            alert("number should be 10 digit")
                        }
                        else if (res === "This email is not in a correct format") {
                            alert("This email is not in a correct format")
                        }
                        else {
                            console.log('error')
                        }
                    },
                    error: (error) => {
                        alert("Please Select Person")
                    }
                });
            }
        </script>
        <%- include('../layout/footer')%>
    </body>

    </html>